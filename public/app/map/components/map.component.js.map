{"version":3,"sources":["../../src/app/map/components/map.component.ts"],"names":[],"mappings":"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","file":"map.component.js","sourcesContent":["import {Component, OnInit} from '@angular/core';\r\nimport {Location} from \"../models/location\";\r\nimport { MyMarker } from '../models/marker';\r\nimport { TrackingService } from \"../../services/TrackingService\";\r\nimport {AgmCoreModule, LatLng, LatLngBounds, MapsAPILoader} from '@agm/core';\r\nimport {unescape} from \"querystring\";\r\nimport {isUndefined} from \"util\";\r\ndeclare var google: any;\r\n@Component({\r\n    selector: 'map',\r\n    templateUrl: './app/map/components/map.component.html',\r\n    styleUrls: ['./app/map/components/map.css'],\r\n})\r\n\r\nexport class MapComponent implements OnInit {\r\n    title: string = 'My first AGM project';\r\n    lat: number = 10.828264;\r\n    lng: number = 106.643006;\r\n    mapDraggable: boolean;\r\n    private internalInterval = null;\r\n    constructor(private trackingService: TrackingService, private _mapsAPILoader: MapsAPILoader) { };\r\n    onClick($event) {\r\n        let latd = $event.coords.lat;\r\n        let long = $event.coords.lng;\r\n    };\r\n    allMarkers: MyMarker[];\r\n    lastPoint : Location;\r\n    ngAfterViewInit() {\r\n        let _this = this;\r\n        this._mapsAPILoader.load().then(() => {\r\n            _this.mapBounds = google.maps.LatLngBounds();\r\n        });\r\n    }\r\n    ngOnInit(): void {\r\n        this.requestLocation();\r\n\r\n    };\r\n    mapBounds : LatLngBounds;\r\n    requestLocation() {\r\n        console.log(this, 'this');\r\n        let _this = this;\r\n        this.trackingService.getLocations(this.trackingService.urlLocation, this.lastPoint).\r\n        then(function(locationObj) {\r\n            // console.log(markers.length, 'location markers');\r\n            console.log(locationObj, 'locationObj');\r\n            _this.allMarkers = locationObj.markers;\r\n            _this.lastPoint = locationObj.lastPoint;\r\n            if (_this.internalInterval == null) {\r\n                _this.fetchMarkers(_this);\r\n            }\r\n        }, function(error) {});\r\n    }\r\n    fetchMarkers(context) {\r\n        //handler to markers\r\n        let _this = context;\r\n        _this.internalInterval = setInterval(function(){\r\n            for (let i = 0; i < _this.allMarkers.length; i++) {\r\n                let marker = _this.allMarkers[i];\r\n                console.log(marker, 'marker in loop');\r\n                _this.handleLocation(marker, _this);\r\n            }\r\n\r\n        }, 2000);\r\n    };\r\n    handleLocation(marker : MyMarker, context) : void {\r\n        /** handle for location */\r\n        console.log(google, 'shit google');\r\n        if (marker.locations.length > 1) {\r\n            let lt : Location = marker.locations.shift();\r\n            marker.currentLocation = lt;\r\n            console.log(context.allMarkers, 'marker.currentLocation');\r\n            let latLng : LatLng = new google.maps.LatLng(lt.lat, lt.lng);\r\n            if (context.mapBounds !== undefined ) {\r\n                context.mapBounds.extend(latLng);\r\n            }\r\n        } else {\r\n            context.requestLocation();\r\n        }\r\n    };\r\n}\r\n\r\n// create new class to handle all change of marker called cluster\r\n// each changing literal, market will be change current location so that their position on map will be changed"],"sourceRoot":"/src"}