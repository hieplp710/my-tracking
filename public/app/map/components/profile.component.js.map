{"version":3,"sources":["../../src/app/map/components/profile.component.ts"],"names":[],"mappings":"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","file":"profile.component.js","sourcesContent":["/**\r\n * Created by hiepl on 7/5/2017.\r\n */\r\n\r\nimport {Component, OnInit} from '@angular/core';\r\nimport { TrackingService } from \"../../services/TrackingService\";\r\nimport $ from 'jquery';\r\n\r\n\r\n@Component({\r\n    selector: 'profile',\r\n    templateUrl: './app/map/components/profile.component.html'\r\n})\r\n\r\nexport class ProfileComponent implements OnInit {\r\n    profile: any;\r\n    isShow: boolean = false;\r\n    profileData: Profile = new Profile();\r\n    error? : any = null;\r\n    constructor(private trackingService: TrackingService) {\r\n        //this.options = new DatePickerOptions();\r\n    };\r\n    ngOnInit() {\r\n        let _this = this;\r\n        $('#btnProfile').on('click', function(e){\r\n           e.preventDefault();\r\n           _this.trackingService.getUserProfile().then(function(resp){\r\n               if (resp) {\r\n                   _this.profile = resp;\r\n                   _this.isShow = true;\r\n                   _this.profileData.phone = _this.profile.phone;\r\n                   _this.profileData.name = _this.profile.name;\r\n                   _this.profileData.email = _this.profile.email;\r\n                   _this.onToggleModal();\r\n               }\r\n           });\r\n        });\r\n    };\r\n    onToggleModal() {\r\n        let overlay = $('<div class=\"overlay open\"></div>');\r\n        if (this.isShow) {\r\n            $('body').append(overlay);\r\n        } else {\r\n            $('div.overlay').remove();\r\n        }\r\n    };\r\n    onClick($event) {\r\n        this.isShow = false;\r\n        this.onToggleModal();\r\n    };\r\n    onSaveProfile($event) {\r\n        //validate and post data\r\n        let _this = this;\r\n        this.error = this.profileData.validate();\r\n        this.trackingService.saveUserProfile({\"data\":this.profileData}).then(function(){\r\n            //success\r\n            _this.isShow = false;\r\n            window.location.reload();\r\n        }, function (err) {\r\n            //error\r\n        });\r\n    };\r\n}\r\n\r\nclass Profile {\r\n    username : string;\r\n    name: string;\r\n    phone : string;\r\n    email?: string;\r\n    password? : string;\r\n    confirmPassword?: string;\r\n    public validate() {\r\n        let errs = {};\r\n        let isValid = true;\r\n        let pattern = /^\\w+@[a-zA-Z_]+?\\.[a-zA-Z]{2,3}$/;\r\n        if ($.trim(this.name) === '') {\r\n            errs['name'] = \"Tên không được để trống!\";\r\n            isValid = false;\r\n        }\r\n        if ($.trim(this.phone) === '' || $.trim(this.phone).length < 10 || !$.isNumeric(this.phone)) {\r\n            errs['phone'] = \"Số điện thoại phải từ 10 số!\";\r\n            isValid = false;\r\n        }\r\n        if (this.email && !pattern.test(this.email)) {\r\n            errs['email'] = \"Sai định dạng email!\";\r\n            isValid = false;\r\n        }\r\n        if ($.trim(this.password) !== '' && $.trim(this.password).length < 6 ) {\r\n            errs['password'] = \"Mật khẩu phải trên 6 ký tự\";\r\n            isValid = false;\r\n        }\r\n        if ($.trim(this.password) !== $.trim(this.confirmPassword) ) {\r\n            errs['confirmPassword'] = \"Mật khẩu và xác nhận không khớp!\";\r\n            isValid = false;\r\n        }\r\n        if (!isValid) {\r\n            return errs;\r\n        }\r\n        return null;\r\n    }\r\n}"],"sourceRoot":"/src"}